<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<record model="ir.actions.act_window" id="action_historical_contract_view_tree">
		<field name="name">Historique Contrat Tree</field>
		<field name="res_model">psi.contract.historical</field>
		<field name="view_type">tree</field>
        <field name="view_mode">tree</field>
	</record>
	<record id="view_historical_contract_tree" model="ir.ui.view">
		<field name="name">Historique Contrat</field>
		<field name="model">psi.contract.historical</field>
		<field name="arch" type="xml">
			<tree string="Historical Contract">
				<field name="date" />
				<field name="ancien" />
				<field name="nouveau" />
				<field name="historical" />
				<field name="debut" />
				<field name="fin" />
			</tree>
		</field>
	</record>
	<record id="hr_contract_view_form_psi" model="ir.ui.view">
		<field name="name">hr.contract.form.psi</field>
		<field name="model">hr.contract</field>
		<field name="inherit_id" ref="hr_contract.hr_contract_view_form" />

		<field name="arch" type="xml">
			<xpath expr="//label" position="before">
				<div class="oe_button_box" name="button_box">
					<button class="oe_inline oe_stat_button" type="action"
						name="%(action_historical_contract_view_tree)d" icon="fa-history">
						<field string="Historique" name="historical_count" widget="statinfo" />
					</button>
				</div>
			</xpath>
			<field name="type_id" position='replace'>
				<field name="type_id" invisible="1" />
			</field>

			<field name="wage" position='after'>
				<field name="psi_professional_category" />
				<field name="psi_sub_category" required="1" />
				<field name="psi_echelon"/>
			</field>

			<field name="working_hours" position="before">
				<field name="work_years" />


			</field>

			<xpath expr="//field[@name='department_id']" position='after'>
				<field name="psi_contract_type" />
				<field name="place_of_work" />
			</xpath>


			<xpath expr="//notebook" position="inside">				
			</xpath>
			<xpath expr="//group[@name='duration_group']" position="after">
				<group name="result_evaluation" string="Résultat de l'évaluation" > <!-- Condition if date_end_trial terminé -->
					<field name="result_evaluation" />
					<!-- <field name="scan_version_file" attrs="{'invisible': [('result_evaluation','=',False)]}"/> -->
					<button string="" class="hidden" /> 
					<button name="action_result_evaluation_send" 
						string="Envoyer le resultat par mail" 
						type="object" 
						class="btn-primary right"
						attrs="{'invisible': [('result_evaluation','=',False)]}"
						/>
				</group>
			</xpath>
			<group name="duration_group" position="after">
				<group name="rupture" string="Rupture de contrat">
					<field name="date_rupture" />
					<field name="motif_rupture" />
					<button name="set_employee_inactif" 
  								type="object" 
								string="Mettre inactif l'employé correspondant"
  								class="oe_highlight"
  								attrs="{'invisible': ['|', ('motif_rupture','=',False),('state','=','close')]}"
  								onClick="$(this).prop('disabled', true);"
  								/>
				</group>
			</group>
			
			<!-- Contract close - READONLY -->			
			<field name='name' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='employee_id' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='job_id' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='department_id' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='psi_contract_type' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='place_of_work' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='wage' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='trial_date_start' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='trial_date_end' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='date_start' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>	
			<field name='date_end' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='working_hours' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='result_evaluation' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='date_rupture' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>		
			<field name='motif_rupture' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>	
			<field name='visa_no' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>	
			<field name='visa_expire' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>	
			<field name='permit_no' position="attributes">
	            <attribute name="attrs">{'readonly':[('state','=','close')]}</attribute>
	        </field>	
		</field>
	</record>



	<!-- Resume and Letters -->
	<record id="hr_contract.ir_attachment_view_search_inherit_hr_employee"
		model="ir.ui.view">
		<field name="name">ir.attachment.search.inherit.contract</field>
		<field name="model">ir.attachment</field>
		<field name="mode">primary</field>
		<field name="inherit_id" ref="base.view_attachment_search" />
		<field name="arch" type="xml">
			<xpath expr="//field[@name='create_date']" position="after">
				<field name="index_content" string="Content" />
			</xpath>
			<xpath expr="//filter[@name='my_documents_filter']" position="attributes">
				<attribute name='invisible'>1</attribute>
			</xpath>
			<xpath expr="//filter[@name='url_filter']" position="attributes">
				<attribute name='invisible'>1</attribute>
			</xpath>
			<xpath expr="//filter[@name='binary_filter']" position="attributes">
				<attribute name='invisible'>1</attribute>
			</xpath>
		</field>
	</record>

	<!-- TODO: What is this ??? -->
	<record model="ir.actions.act_window" id="hr_contract_resumes">
		<field name="name">Resumes and Letters</field>
		<field name="res_model">ir.attachment</field>
		<field name="view_type">form</field>
		<field name="view_mode">kanban,tree,form</field>
		<field name="view_id" ref="mail.view_document_file_kanban" />
		<field name="search_view_id"
			ref="hr_contract.ir_attachment_view_search_inherit_hr_employee" />
		<field name="domain">[('res_model','=','hr.employee')]</field>
		<field name="context">{'create': False}</field>
		<field name="help" type="html">
			<p>
				No document yet.
			</p>
			<p>
				This menu helps you search through resumes and motivation
				letters.
				Odoo automatically indexes .PDF, .DOC, DOCX, .TXT
				files so that you
				can search keywords from the content of these
				files.
			</p>
		</field>
	</record>

	<record id="hr_contract_form_view_wage_grids" model="ir.ui.view">
		<field name="name">hr.wage.grid.form</field>
		<field name="model">hr.wage.grid</field>
		<field name="arch" type="xml">
			<form string="form grille salariale">
				<field name="wage_grid_details">
					<tree string="Wage Grid Details" editable="bottom" create="false"
						delete="false">
						<field name="psi_professional_category" />
						<field name="name" />
						<field name="psi_category" />
						<field name="psi_sub_category" />
						<field name="echelon_1" />
						<field name="echelon_2" />
						<field name="echelon_3" />
						<field name="echelon_4" />
						<field name="echelon_5" />
						<field name="echelon_6" />
						<field name="echelon_7" />
						<field name="echelon_8" />
						<field name="echelon_9" />
						<field name="echelon_10" />
						<field name="echelon_11" />
						<field name="echelon_12" />
						<field name="echelon_13" />
						<field name="echelon_14" />
						<field name="echelon_15" />
						<field name="echelon_16" />
						<field name="echelon_17" />
						<field name="echelon_18" />
						<field name="echelon_19" />
						<field name="echelon_20" />
						<field name="echelon_hc" />
					</tree>
				</field>
			</form>
		</field>
	</record>

	<record id="hr_contract_kanban_view_wage_grids" model="ir.ui.view">
		<field name="name">hr.wage.grid.kanban</field>
		<field name="model">hr.wage.grid</field>
		<field name="priority">10</field>
		<field name="arch" type="xml">
			<kanban class="o_hr_employee_kanban">
				<templates>
					<t t-name="kanban-box">
						<div class="oe_kanban_global_click">

							<div class="o_kanban_image">

								<div class="o_employee_summary_icons">
									<span class='oe_kanban_mail_new' title='Unread Messages'>
										<i class='fa fa-comments' />
									</span>
									<span title='Messages'>
										<i class='fa fa-comments' />
									</span>
									<span title='Followers'>
										<i class='fa fa-users' />
									</span>
								</div>
							</div>
							<div class="oe_kanban_details">
								<strong>
									<field name="name" />
								</strong>
								<ul>
									<li id="last_login" />
									<li></li>
									<li></li>
									<li>
										<i class="fa fa-envelope"></i>
									</li>
									<li>
										<i class="fa fa-phone"></i>
									</li>
									<li>
										<i class="fa fa-mobile"></i>
									</li>
								</ul>

							</div>
						</div>
					</t>
				</templates>
			</kanban>

		</field>
	</record>

	<record id="open_contract_wage_grid" model="ir.actions.act_window">
		<field name="name">Grille Salariale</field>
		<field name="res_model">hr.wage.grid</field>
		<field name="view_type">form</field>
		<field name="view_mode">kanban,form</field>
		<field name="domain">[]</field>
		<field name="context">{}</field>
		<field name="view_id" eval="False" />
		<field name="help" type="html">
			<p class="oe_view_nocontent_create">
				Grille Salariale
			</p>
		</field>
	</record>

	<menuitem id="menu_contract_wage_grid" action="open_contract_wage_grid"
		parent="hr.menu_hr_root" sequence="5" />

</odoo>
