<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record id="grp_recruitement" model="res.groups">
			<field name="name">Recrutement</field>
		</record>

		<record id="crm_case_form_view_job_inherit1" model="ir.ui.view">
			<field name="name">Ajout des boutons du workflow</field>
			<field name="model">hr.applicant</field>
			<field name="inherit_id" ref="hr_recruitment.crm_case_form_view_job" />
			<field name="arch" type="xml">
			    <div class="oe_title" position="replace">
			    		<div class="oe_title">
	                    <label for="partner_name" class="oe_edit_only"/>
	                    <h1><field name="partner_name"/></h1>
	                    <h2 class="o_row">
	                        <div>
	                            <span style="font-size: 13px" class="oe_edit_only">Prénom</span>
	                            <field name="name" nolabel="1"/>
	                        </div>
	                        <div>
	                            <label for="categ_ids" class="oe_edit_only"/>
	                            <field name="categ_ids" widget="many2many_tags" options="{'no_create_edit': True}"/>
	                        </div>
	                    </h2>
	                </div>
			    </div>
			  <field name="email_from" position="replace">
			  	<field name="email_from" required="1" />
			  </field>
				<field name="partner_id" position="before">
					<field name="birthday" attrs="{'required': True}" />
					<field name="age" />
					<field name="date_verification_bridger_insight" invisible="1" />
					<field name="country_id" attrs="{'required': True}" />
					<field name="sexe" attrs="{'required': True}" />
					<field name="marital" attrs="{'required': True}" />
					<field name="number_of_dependent_children" attrs="{'required': True}" />
					<field name="recrutement_type_id" />
					<field name="recrutement_type" invisible="1" />
				</field>
				<field name="source_id" position="after">
					<group string="Avis sur la candidature">
						<h2>
							<label for="correspondance_profil" />
							<field name="correspondance_profil" />
						</h2>
					</group>
					<group string="Note Shortlist">
						<field name="psi_note_hr" attrs="{'required': [('state','=',('applicant_selected'))]}" />
						<field name="psi_note_candidate" attrs="{'required': [('state','=',('applicant_selected'))]}" />
						<field name="psi_average_note" />
					</group>
					<group string="Note Test">
						<field name="psi_note_test_rh" attrs="{'required': [('state','=',('convoked_for_test'))]}" />
						<field name="psi_note_test_candidate" attrs="{'required': [('state','=',('convoked_for_test'))]}" />
						<field name="psi_average_note_test" />
					</group>
					<group string="Note Entretien">
						<field name="psi_note_interview" />
					</group>
					<group string="Total des notes">
						<h2>
							<label for="psi_total_note" />
							<field name="psi_total_note" />
						</h2>
					</group>
					<group>
						<field name="b_liste_restreinte" />
					</group>
					
				</field>

				<field name="type_id" position="replace">
					<field name="type_id" invisible="1" />
				</field>
				<field name="user_id" position="replace">
					<field name="user_id" invisible="1" />
				</field>
				<field name="reference" position="replace">
					<field name="reference" invisible="1" />
				</field>
				<field name="medium_id" position="replace">
					<field name="medium_id" invisible="1" />
				</field>
				<field name="source_id" position="replace">
					<field name="source_id" invisible="1" />
				</field>
				<field name="priority" position="replace">
					<field name="priority" invisible="1" />
				</field>
				<field name="description" position="before">
					<div>
						<label for="parents_employed_in_psi" />
						<field name="parents_employed_in_psi" class="oe_inline" />
					</div>
					<p attrs="{'invisible': [('parents_employed_in_psi', '!=', 'true')]}">Dans l'affirmatif, donnez les renseignements suivants:
					</p>
					<field name="parent_information_employees" colspan="2"
						attrs="{'invisible': [('parents_employed_in_psi', '!=', 'true')]}">
						<tree string="Experience requise" editable="bottom">
							<field name="name" />
							<field name="degree_of_relationship" />
							<field name="post_office_title" />
						</tree>
					</field>
					<div>
						<label for="already_answered_application" />
						<field name="already_answered_application" class="oe_inline" />
					</div>
					<p attrs="{'invisible': [('already_answered_application', '!=', 'true')]}">
						Dans l'affirmatif, à quel moment ? Pour quel poste et à
						quelle période ?:
					</p>
					<field name="description_already_answered_application"
						attrs="{'invisible': [('already_answered_application', '!=', 'true')]}">
						<tree string="" editable="bottom">
							<field name="name" />
							<field name="period" />
						</tree>
					</field>
					<field name="linguistic_knowledge">
						<tree string="" editable="bottom">
							<field name="name" />
							<field name="written" />
							<field name="spoken" />
							<field name="listen" />
						</tree>
					</field>
					
					<h2>Etudes Universitaires</h2>
					<p>Veuillez donner l'intitulé exact de chaque diplôme ou titre
						universitaire dans la langue dans laquelle il a été établi, et non
						une traduction ou un équivalent.
					</p>
					<field name="university_studies">
						<tree string="" editable="bottom">
							<field name="name" />
							<field name="city" />
							<field name="country_id" />
							<field name="from_date" />
							<field name="end_date" string="a"/>
							<field name="degree" />
							<field name="study_domain" />
						</tree>
					</field>
					<h2>Etudes secondaires, techniques ou apprentissage</h2>
					<field name="secondary_studies">
						<tree string="" editable="bottom">
							<field name="name" />
							<field name="city" />
							<field name="country_id" />
							<field name="from_date" />
							<field name="end_date" string="a"/>
							<field name="degree" />
							<field name="study_domain" />
						</tree>
					</field>
					<h2>Fonctions Antérieures :</h2>
					<p>En partant de votre poste actuel, indiquez, dans l'ordre
						chronologique inverse, tous les postes que vous avez occupés
					</p>
					<field name="previous_functions">
						<tree colspan="2">
							<field name="begin_date" />
							<field name="end_date" string="a"/>
							<field name="last_basic_salary"/>
							<field name="vola"/>
							<field name="title_function" required="1" />
							<field name="employer" required="1"/>
							<field name="type_of_activity" />
							<field name="address" required="1"/>
							<field name="name_of_supervisor" />
							<field name="number_of_supervised" />
							<field name="reason_for_leaving" />
							<field name="mobile_phone" required="1"/>
							<field name="work_email" />
							<field name="description" />
							<field name="psi_applicant_id" invisible="1" />
							<field name="duree"/>
						</tree>
						<form>
							<group col="2">
								<group>
									<field name="begin_date" />
									<field name="end_date" string="a"/>
								</group>
								<group>
									<div class="pull-left">
										<label for="last_basic_salary">Dérnier salaire de base</label>
										<field name="last_basic_salary"/>
									</div>
									<div class="pull-right">
										<field name="vola" style="display:inline-block;bottom:0px" nolabel="1"/>
									</div>
								</group>
								<group>
									<field name="employer" required="1"/>
									<field name="type_of_activity" />
								</group>
								<group>
									<field name="address" required="1"/>
									<field name="description" />
								</group>
								<group>
									<field name="name_of_supervisor" />
									<field name="number_of_supervised" />
								</group>
								<group>
									<field name="reason_for_leaving" />
								</group>
								<group>
									<field name="mobile_phone" required="1"/>
									<field name="work_email" />
								</group>
								<group>
									<field name="psi_applicant_id" invisible="1" />
									<field name="duree"/>
								</group>
							</group>
						</form>
					</field>
					<label for="current_employer_report" />
					<field name="current_employer_report" class="oe_inline"/>
					<h2>Références professionnelles</h2>
					<p>
						Donnez le nom et l'adresse des trois personnes avec qui vous
						avez travaillé étroitement, n'ayant avec vous aucun lien de
						parenté
						et connaissant votre moralité et vos valeurs
						professionnelles
					</p>
					<field name="professional_references">
						<tree string="" editable="bottom">
							<field name="name" required="1"/>
							<field name="function_title" required="1"/>
							<field name="company" required="1"/>
							<field name="mobile_phone" required="1"/>
							<field name="work_email" required="1"/>
						</tree>
					</field>
					<b>
						Par la présente, j'autorise PSI Madagascar à prendre
						contact avec les personnes
						de références citées ci-dessus.
					</b>
					<span><br/><br/></span>
					<div>
						<label for="bridger_insight" string="Avez-vous jamais été arrêté, inculpé ou poursuivi au criminel ? Avez-vous
							jamais été reconnu coupable ou condamné à une autre amende ou une
							peine de prison pour un délit (autre qu'une infraction en matiére
							de circulation) ?"/>
						<field name="bridger_insight" class="oe_inline" />
					</div>
					<span><br/></span>
					<div>
						<label for="affirmative_bridger_insight" attrs="{'invisible': [('bridger_insight', '!=', 'true')]}"/>
						<field name="affirmative_bridger_insight" attrs="{'invisible': [('bridger_insight', '!=', 'true')]}"/>
					</div>
					
				</field>

				<field name="type_id" position="after">

					<field name="experiences" placeholder="Resumé de votre experience (250 mots)"
						invisible="1" />

					<field name="number_of_years_of_experience" invisible="1" />

					<field name="nature_recrutement_id" invisible="1" />
				</field>
				
				<field name="availability" position="replace">
				   	<field name="availability" attrs="{'invisible': [('recrutement_type', '=', 'stagiaire')]}" />
				</field>
				<xpath expr="//label[@for='salary_expected']" position='replace'>
					<!-- <label for="salary_expected" attrs="{'invisible': [('recrutement_type', '=', 'stagiaire')]}" /> -->
					<div >
					    <label for="salary_expected" string="Salaire demandée" attrs="{'invisible': ['|', ('recrutement_type', '=', 'consultant'), ('recrutement_type', '=', 'stagiaire')]}"/>
					    <label for="salary_expected" string="Honoraire demandée" attrs="{'invisible': ['|', ('recrutement_type', '!=', 'consultant'), ('recrutement_type', '=', 'stagiaire')]}" />
					</div>
				</xpath>
				<xpath expr="//field[@name='salary_expected']" position='replace'>
					<field name="salary_expected" required="1" attrs="{'invisible': [('recrutement_type', '=', 'stagiaire')], 'required':[('state', 'in', ('psi_wage_proposal','honorary_proposal'))]}" />
				    <field name="devise_extra" class="oe_inline" />
				</xpath>
				<xpath expr="//field[@name='salary_expected_extra']" position='replace'>
					<field name="salary_expected_extra" invisible="1" />
				</xpath>
				
				<xpath expr="//label[@for='salary_proposed']" position='replace'>
					<!-- <label for="salary_proposed" attrs="{'invisible': [('recrutement_type', '=', 'stagiaire')]}" /> -->
					<div >
					    <label for="salary_proposed" string="Salaire proposée" attrs="{'invisible': ['|', ('recrutement_type', '=', 'consultant'), ('recrutement_type', '=', 'stagiaire')]}"/>
					    <label for="salary_proposed" string="Honoraire proposée" attrs="{'invisible': ['|', ('recrutement_type', '!=', 'consultant'), ('recrutement_type', '=', 'stagiaire')]}"/>
					</div>
				</xpath>
			
				<xpath expr="//field[@name='salary_proposed']" position='replace'>
					<div>
						<field name="salary_proposed" required="1" attrs="{'invisible': [('recrutement_type', '=', 'stagiaire')], 'required':[('state', 'in', ('psi_wage_proposal','honorary_proposal'))]}" class="oe_inline"/>
				    	<field name="devise_proposed" class="oe_inline"/>
				    </div>
				</xpath>
				<xpath expr="//field[@name='salary_proposed_extra']" position='replace'>
					<field name="salary_proposed_extra" invisible="1" />
				</xpath>
				
				<field name="availability" position="after">
				    <field name="psi_allowance" attrs="{'invisible': [('recrutement_type', '!=', 'stagiaire')]}" />
					<field name="psi_salary_type" attrs="{'invisible': [('recrutement_type', '=', 'consultant')]}" />
					<field name="psi_salary_negotiable" attrs="{'invisible': [('recrutement_type', '=', 'stagiaire')]}" />
				</field>
				
				<button name="create_employee_from_applicant" position="replace">
					<button string="Create Employee" name="create_employee_from_applicant"
						type="object" class="oe_highlight"
						attrs="{'invisible': ['|',('emp_id', '!=', False),('active', '=', False)]}"
						invisible="1" />
				</button>
				<field name="stage_id" position="before">
					<button name="button_convoked_for_test" string="Convoqué pour les tests"
					attrs="{'invisible': ['|','|','|',('b_liste_restreinte','=',False),('state','!=','applicant_selected'),('nature_recrutement_id', '=', 'conssideration_dossier'),('recrutement_type','=','collaborateur_externe')]}" /> -->
					<button name="button_interview" string="Entretiens"
						attrs="{'invisible': ['|','|',('b_liste_restreinte','=',False),('state','not in',('convoked_for_test', 'applicant_selected')),('nature_recrutement_id', '=', 'conssideration_dossier')]}" />
					<button name="button_consultant_consideration_de_dossier"
						string="Passer aux Références professionnelles"
						attrs="{'invisible': ['|','|',('b_liste_restreinte','=',False),('state','!=','applicant_selected'),('nature_recrutement_id', '!=', 'conssideration_dossier')]}" />
					<button name="button_professional_reference" string="Références professionnelles"
						attrs="{'invisible': ['|',('state','!=','interview'),('recrutement_type', '=', 'stagiaire')]}" />
					<button name="button_bridger_insight_trainee_interview"
						string="Bridger Insight"
						attrs="{'invisible': ['|',('state','!=','interview'),('recrutement_type','!=','stagiaire')]}" />
					<button name="button_bridger_insight" string="Bridger Insight"
						attrs="{'invisible': [('state','!=','professional_reference')]}" />
					<button name="button_psi_wage_proposal" string="Proposition salariale"
						attrs="{'invisible': ['|','|',('state','!=','bridger_insight'),('recrutement_type', '=', 'consultant'),('recrutement_type', '=', 'stagiaire')]}" />
					<button name="button_benefits" string="Indeminites"
						attrs="{'invisible': ['|',('state','!=','bridger_insight'),('recrutement_type', '!=', 'stagiaire')]}" />
					<button name="button_psi_honorary_proposal" string="Proposition honoraire"
						attrs="{'invisible': ['|',('state','!=','bridger_insight'),('recrutement_type', '!=', 'consultant')]}" />
					<button name="button_notification_of_employment" string="Notification d'embauche"
						attrs="{'invisible': ['|',('state','!=','psi_wage_proposal'),('recrutement_type', '=', 'consultant')]}" />
					<!-- <button name="button_notification_of_employment" string="Notification 
						d'embauche" states="psi_wage_proposal" type="object" class="oe_highlight"/> -->
					<button name="button_contract_established_consultant"
						string="Etablir contrat"
						attrs="{'invisible': ['|',('state','!=','honorary_proposal'),('recrutement_type', '!=', 'consultant')]}" />
					<button string="Refuser" name="button_refuser" 
						attrs="{'invisible': [('state','not in',('interview', 'professional_reference', 'bridger_insight', 'psi_wage_proposal'))]}" />
					<button name="button_contract_established" string="Etablir contrat"
						attrs="{'invisible': [('state','!=','notification_of_employment')]}" />
					<button name="button_internship_contract" string="Etablir Contrat de stagiaire"
						attrs="{'invisible': [('state','!=','benefits')]}" />
					<button name="action_archived" string="Déplacer dans candidatures reçues" type="object"
						attrs="{'invisible': [('state','!=','archived')]}" />
				</field>
				<field name="stage_id" position="replace">
					<field name="state" widget="statusbar"
						attrs="{'invisible': [('active', '=', False)]}"
						statusbar_visible="applicant_selected,convoked_for_test,interview,professional_reference,bridger_insight,psi_wage_proposal,notification_of_employment,contract_established,archived" />
				</field>

				<button name="archive_applicant" position="replace" type='object'>
					<button name="archive_applicant"
						attrs="{'invisible': ['|','|',('state', '=', 'contract_established'),('state', '=', 'internship_contract'),('state', '=', 'contract_established_consultant')]}" />
				</button>
			</field>
		</record>

		<record model="ir.ui.view" id="crm_case_tree_view_job2">
			<field name="name">Applicants</field>
			<field name="model">hr.applicant</field>
			<field name="inherit_id" ref="hr_recruitment.crm_case_tree_view_job" />
			<field name="arch" type="xml">
				<field name="partner_name" position="after">
					<field name="age" />
				</field>
				<field name="job_id" position="after">
					<field name="application_deadline_date" />
					<field name="university_studies_degree" />
				</field>

				<field name="medium_id" position="replace">
					<field name="medium_id" invisible="1" />
				</field>
				<field name="source_id" position="replace">
					<field name="source_id" invisible="1" />
				</field>
				<field name="priority" position="replace">
					<field name="priority" invisible="1" />

				</field>	
				
				<field name="stage_id" position="replace">
					<field name="state"/>
				</field>
				
				<field name="state" position="after">
					<field name="psi_average_note"/>
					<field name="psi_average_note_test"/>
					<field name="psi_note_interview" attrs="{'required': [('state','=','interview')]}" />
					<field name="psi_total_note"/>
				</field>
	        </field>
	    </record>
	    
	    <!-- vue kanban filtré par state -->
	    <record id="kanban_psi" model="ir.ui.view">
			<field name="name">kanban cabinet</field>
			<field name="model">hr.applicant</field>
			<field name="mode">primary</field>
			<field name="inherit_id" ref="hr_recruitment.hr_kanban_view_applicant" />
			<field name="arch" type="xml">
				<kanban position="attributes">
	                <attribute name="edit">false</attribute>
	                <attribute name="quick_create">false</attribute>
	                <attribute name="default_group_by">state</attribute>
	            </kanban>

			</field>
		</record>

		<record model="ir.ui.view" id="hr_recruitment_stage_form1">
			<field name="name">hr.recruitment.stage.form1</field>
			<field name="model">hr.recruitment.stage</field>
			<field name="inherit_id" ref="hr_recruitment.hr_recruitment_stage_form" />
			<field name="arch" type="xml">
				<field name="job_id" position='after'>
					<field name="recrutement_type_ids" widget="many2many_tags" />
				</field>
			</field>
		</record>

		<!-- type de recrutment Tree View -->
		<record model="ir.ui.view" id="hr_recruitment_type_tree">
			<field name="name">hr.recruitment.type</field>
			<field name="model">hr.recruitment.type</field>
			<field name="arch" type="xml">
				<tree string="Type de recrutement">
					<field name="name" />
					<field name="recrutement_type" />
				</tree>
			</field>
		</record>

		<!-- type de recrutment form view -->
		<record id="hr_recruitment_type_form" model="ir.ui.view">
			<field name="name">hr.recruitment.type</field>
			<field name="model">hr.recruitment.type</field>
			<field name="arch" type="xml">
				<form string="Create recruitement type">
					<sheet>
						<group>
							<field name="name" placeholder="Nom du type de recrutement"
								required="1" />
							<field name="recrutement_type" placeholder="Type de recrutement"
								required="1" />
						</group>
					</sheet>
				</form>
			</field>
		</record>

		<!-- Type de recrutement menu action -->
		<record model="ir.actions.act_window" id="action_type_recrutement">
			<field name="name">Type de recrutement</field>
			<field name="res_model">hr.recruitment.type</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">
					Click here to create a new recruitement type .
				</p>
			</field>
		</record>
		<!-- -->

		<!-- Menu Type de recrutement -->
		<menuitem id="menu_hr_recruitment_type_recrutement" name="Type de recrutement"
			parent="hr_recruitment.menu_hr_recruitment_configuration" action="action_type_recrutement"
			sequence="2" />
		<!-- -->

		<record id="hr_recrutement_candidature_tree_filter" model="ir.ui.view">
			<field name="name">hr.recrutement.candidature.tree.filter</field>
			<field name="model">hr.applicant</field>
			<field name="arch" type="xml">
				<search string="Recherche">
					<field name="recrutement_type_id" string="Type de recrutement" />
					<filter name="recrutement_type_filter_permanent" string="Collaborateur permanent" icon="terp-personal+" domain="[('recrutement_type_id.recrutement_type', '=', 'collaborateur')]" />
					<filter name="recrutement_type_filter_consultant" string="Consultant" icon="terp-personal+" domain="[('recrutement_type_id.recrutement_type', '=', 'consultant')]" />
					<filter name="recrutement_type_filter_stagiaire" string="Stagiaire" icon="terp-personal+" domain="[('recrutement_type_id.recrutement_type', '=', 'stagiaire')]" />
					<filter name="recrutement_type_filter_externe" string="Cabinet externe" icon="terp-personal+" domain="[('recrutement_type_id.recrutement_type', '=', 'collaborateur_externe')]" />
					<field name="job_id" string="Job concerné" />
					<field name="partner_name" string="Nom du candidat" />
					<group expand="0" string="Group By...">
						<filter string="Long listing" icon="terp-personal+" domain="[]" />
						<filter string="Short listing" icon="terp-personal+"
							domain="[('correspondance_profil','=','oui'), ('b_liste_restreinte','=',False)]" />
						<filter string="Liste Restreinte" icon="terp-personal+"
							domain="[('b_liste_restreinte','=',True)]" />
					</group>
				</search>
			</field>
		</record>

		<record id="hr_applicant_liste_restreinte_add_action" model="ir.actions.server">
			<field name="name">Ajouter a la liste restreinte</field>
			<field name="model_id" ref="model_hr_applicant" />
			<field name="state">code</field>
			<field name="code">record.set_to_liste_restreinte(True)</field>
		</record>
		<record id="hr_applicant_liste_restreinte_remove_action" model="ir.actions.server">
			<field name="name">Enlever de la liste restreinte</field>
			<field name="model_id" ref="model_hr_applicant" />
			<field name="state">code</field>
			<field name="code">record.set_to_liste_restreinte(False)</field>
		</record>

		<record id="hr_applicant_liste_restreinte_action_multi" model="ir.values">
			<field name="model_id" ref="model_hr_applicant" />
			<field name="name">add liste restreinte</field>
			<field name="key2">client_action_multi</field>
			<field name="key">action</field>
			<field name="model">hr.applicant</field>
			<field name="value"
				eval="'ir.actions.server,' + str(ref('hr_applicant_liste_restreinte_add_action'))" />
		</record>
		<record id="hr_applicant_liste_restreinte_remove_multi" model="ir.values">
			<field name="model_id" ref="model_hr_applicant" />
			<field name="name">remove liste restreinte</field>
			<field name="key2">client_action_multi</field>
			<field name="key">action</field>
			<field name="model">hr.applicant</field>
			<field name="value"
				eval="'ir.actions.server,' + str(ref('hr_applicant_liste_restreinte_remove_action'))" />
		</record>

	</data>
</odoo>
