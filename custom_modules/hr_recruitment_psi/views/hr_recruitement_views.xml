<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<record id="grp_recruitement" model="res.groups">
			<field name="name">Recrutement</field>
		</record>

		<record id="crm_case_form_view_job_inherit1" model="ir.ui.view">
			<field name="name">Ajout des boutons du workflow</field>
			<field name="model">hr.applicant</field>
			<field name="inherit_id" ref="hr_recruitment.crm_case_form_view_job" />
			<field name="arch" type="xml">
				<field name="partner_id" position="before">
					<field name="age" />
					<field name="sex" />
					<field name="recrutement_type_id" />
					<field name="recrutement_type" invisible="1" />
				</field>
				<field name="type_id" position="after">
					<field name="experiences" placeholder="Resumé de votre experience (250 mots)"></field>
					<field name="number_of_years_of_experience"></field>
					<field name="correspondance"></field>
					<field name="psi_note_hr" attrs="{'required': [('state','in',('interview'))]}" />
					<field name="psi_note_candidate"></field>
					<field name="nature_recrutement_id" invisible="1" />
				</field>
				<button name="create_employee_from_applicant" position="replace">
					<button string="Create Employee" name="create_employee_from_applicant"
						type="object" class="oe_highlight"
						attrs="{'invisible': ['|',('emp_id', '!=', False),('active', '=', False)]}"
						invisible="1" />
				</button>
				<field name="stage_id" position="before">					
					<button name="button_convoked_for_test" string="Convoqué pour les tests"
						attrs="{'invisible': ['|',('state','!=','applicant_selected'),('nature_recrutement_id', '=', 'conssideration_dossier')]}" />
					<button name="button_interview" string="Entretiens"
						attrs="{'invisible': ['|',('state','not in',('convoked_for_test', 'applicant_selected')),('nature_recrutement_id', '=', 'conssideration_dossier')]}" />					
					<button name="button_consultant_consideration_de_dossier" string="Passer aux Références professionnelles"
						attrs="{'invisible': ['|',('state','!=','applicant_selected'),('nature_recrutement_id', '!=', 'conssideration_dossier')]}" />
					<button name="button_professional_reference" string="Références professionnelles"
						attrs="{'invisible': [('state','!=','interview')]}" />
					<button name="button_bridger_insight" string="Brider Insight"
						attrs="{'invisible': [('state','!=','professional_reference')]}" />
					<button name="button_psi_wage_proposal" string="Proposition salariale"
						attrs="{'invisible': ['|',('state','!=','bridger_insight'),('recrutement_type', '=', 'consultant')]}" />
					<button name="button_psi_honorary_proposal" string="Proposition honoraire"
						attrs="{'invisible': ['|',('state','!=','bridger_insight'),('recrutement_type', '!=', 'consultant')]}" />
					<button name="button_notification_of_employment" string="Notification d'embauche" 
						attrs="{'invisible': ['|',('state','!=','psi_wage_proposal'),('recrutement_type', '=', 'consultant')]}"/>					
					<button name="button_notification_of_employment" string="Notification d'embauche" 
						attrs="{'invisible': ['|',('state','!=','psi_wage_proposal'),('recrutement_type', '=', 'consultant')]}" />
					<button name="button_contract_established_consultant" string="Etablir contrat" 
						attrs="{'invisible': ['|',('state','!=','psi_wage_proposal'),('recrutement_type', '!=', 'consultant')]}" />							
					<button string="Refuse" name="mail_refuse_applicant" type="object" 
					 	attrs="{'invisible': [('state','not in',('interview', 'professional_reference', 'bridger_insight', 'psi_wage_proposal'))]}"/>					 			
					<button name="button_contract_established" string="Etablir contrat"
						attrs="{'invisible': [('state','!=','notification_of_employment')]}" />						
				</field>
				<field name="stage_id" position="replace">
					<field name="state" widget="statusbar" 
	        	    attrs="{'invisible': [('active', '=', False)]}"
					statusbar_visible="applicant_selected,convoked_for_test,interview,professional_reference,bridger_insight,psi_wage_proposal,notification_of_employment,contract_established" />
				</field>
				
				<button name="archive_applicant" position="replace" type='object'>
					<button name="archive_applicant"  
	        	    attrs="{'invisible': [('state', '=', 'contract_established')]}" />
				</button>
			</field>
		</record>

		<record model="ir.ui.view" id="hr_recruitment_stage_form1">
			<field name="name">hr.recruitment.stage.form1</field>
			<field name="model">hr.recruitment.stage</field>
			<field name="inherit_id" ref="hr_recruitment.hr_recruitment_stage_form" />
			<field name="arch" type="xml">
				<field name="job_id" position='after'>
					<field name="recrutement_type_ids" widget="many2many_tags" />
				</field>
			</field>
		</record>

		<!-- type de recrutment Tree View -->
		<record model="ir.ui.view" id="hr_recruitment_type_tree">
			<field name="name">hr.recruitment.type</field>
			<field name="model">hr.recruitment.type</field>
			<field name="arch" type="xml">
				<tree string="Type de recrutement">
					<field name="name" />
					<field name="recrutement_type" />
				</tree>
			</field>
		</record>

		<!-- type de recrutment form view -->
		<record id="hr_recruitment_type_form" model="ir.ui.view">
			<field name="name">hr.recruitment.type</field>
			<field name="model">hr.recruitment.type</field>
			<field name="arch" type="xml">
				<form string="Create recruitement type">
					<sheet>
						<group>
							<field name="name" placeholder="Nom du type de recrutement"
								required="1" />
							<field name="recrutement_type" placeholder="Type de recrutement"
								required="1" />
						</group>
					</sheet>
				</form>
			</field>
		</record>

		<!-- Type de recrutement menu action -->
		<record model="ir.actions.act_window" id="action_type_recrutement">
			<field name="name">Type de recrutement</field>
			<field name="res_model">hr.recruitment.type</field>
			<field name="view_type">form</field>
			<field name="view_mode">tree,form</field>
			<field name="help" type="html">
				<p class="oe_view_nocontent_create">
					Click here to create a new recruitement type .
				</p>
			</field>
		</record>
		<!-- -->

		<!-- Menu Type de recrutement -->
		<menuitem id="menu_hr_recruitment_type_recrutement" name="Type de recrutement"
			parent="hr_recruitment.menu_hr_recruitment_configuration" action="action_type_recrutement"
			sequence="2" />
		<!-- -->

		<record id="hr_recrutement_candidature_tree_filter" model="ir.ui.view">
	        <field name="name">hr.recrutement.candidature.tree.filter</field>
	        <field name="model">hr.applicant</field>
	        <field name="arch" type="xml">	
				<search string="Recherche">
					<field name="job_id" string="Job concerné" />
					<group expand="0" string="Group By...">
						   <filter string="Long listing" icon="terp-personal+" domain="[]"/>
	                       <filter string="Short listing" icon="terp-personal+" domain="[('correspondance','=','oui')]" />
	                       <filter string="Liste Restreinte" icon="terp-personal+" domain="[('psi_average_note','>=',2)]" />
	                </group>
				</search>
	       </field>
	    </record>
    
	</data>
</odoo>